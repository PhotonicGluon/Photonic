---
import { getCollection } from "astro:content";
import { toProject } from "@lib/projects/project";

import ProjectFilters from "@components/projects/ProjectFilters";
import ProjectList from "@components/projects/ProjectList";

import MainLayout from "@layouts/MainLayout.astro";

// Update project items store
const rawProjects = await getCollection("projects");

// Separate raw data into project IDs and projects
const projectIDs = rawProjects.map((rawProject) => rawProject.id);
const projects = rawProjects.map((rawProject) => toProject(rawProject.data));
---

<MainLayout class="grid grid-cols-5 divide-x-2 divide-solid divide-gray-500" title="Projects">
    <section
        id="filters"
        class="sticky top-3 col-span-1 col-start-1 self-start motion-safe:duration-1000 motion-safe:animate-in motion-safe:fade-in motion-safe:slide-in-from-left-8"
    >
        <ProjectFilters ids={projectIDs} projects={projects} client:load />
    </section>
    <section id="projects" class="col-span-4 col-start-2">
        <ProjectList
            class="motion-safe:duration-1000 motion-safe:animate-in motion-safe:fade-in motion-safe:slide-in-from-right-8"
            client:load
        />
    </section>
</MainLayout>
